---
title: Cron Jobs Setup
description: Configure automated cron jobs for recurring invoices and reminders
navigation:
  icon: i-lucide-clock
seo:
  title: Cron Jobs Configuration
  description: Guide to setting up automated cron jobs.
---

## Overview

OpenInvoice uses cron jobs for automated tasks like generating recurring invoices and sending payment reminders.

## Prerequisites

- Cron job service (GitHub Actions, Vercel Cron, etc.)
- `CRON_SECRET` environment variable

## Available Cron Jobs

### 1. Recurring Invoice Generation

**Endpoint**: `/api/cron/recurring-invoices`

**Schedule**: Daily (or as configured)

**Purpose**: Generate invoices from recurring templates

### 2. Payment Reminders

**Endpoint**: `/api/cron/payment-reminders`

**Schedule**: Daily

**Purpose**: Send payment reminder emails

### 3. Payment Retry

**Endpoint**: `/api/cron/payment-retry`

**Schedule**: Hourly

**Purpose**: Retry failed payment transactions

## Configuration

### Environment Variable

```env
CRON_SECRET=your-secret-key-here
```

Generate a secure secret:

```bash [Terminal]
openssl rand -hex 32
```

### Securing Endpoints

Cron endpoints verify the secret:

```typescript
if (req.headers.get('authorization') !== `Bearer ${process.env.CRON_SECRET}`) {
  return new Response('Unauthorized', { status: 401 });
}
```

## GitHub Actions Setup

### Workflow File

Create `.github/workflows/cron.yml`:

```yaml
name: Cron Jobs

on:
  schedule:
    - cron: '0 0 * * *' # Daily at midnight UTC
  workflow_dispatch:

jobs:
  recurring-invoices:
    runs-on: ubuntu-latest
    steps:
      - name: Generate Recurring Invoices
        run: |
          curl -X POST https://yourdomain.com/api/cron/recurring-invoices \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}"
  
  payment-reminders:
    runs-on: ubuntu-latest
    steps:
      - name: Send Payment Reminders
        run: |
          curl -X POST https://yourdomain.com/api/cron/payment-reminders \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}"
```

### GitHub Secrets

1. Go to repository **Settings** â†’ **Secrets**
2. Add `CRON_SECRET` secret
3. Use in workflow

## Vercel Cron Setup

### vercel.json

```json
{
  "crons": [
    {
      "path": "/api/cron/recurring-invoices",
      "schedule": "0 0 * * *"
    },
    {
      "path": "/api/cron/payment-reminders",
      "schedule": "0 0 * * *"
    }
  ]
}
```

## Testing

### Manual Trigger

Test endpoints manually:

```bash [Terminal]
curl -X POST http://localhost:3000/api/cron/recurring-invoices \
  -H "Authorization: Bearer your-cron-secret"
```

### Local Testing

Run cron logic locally:

```typescript
// Test recurring invoice generation
const templates = await getDueTemplates();
for (const template of templates) {
  await generateInvoiceFromTemplate(template);
}
```

## Monitoring

### Logs

Monitor cron job execution:
- Check application logs
- Review error tracking (Sentry)
- Monitor database changes

### Alerts

Set up alerts for:
- Failed cron jobs
- Missing executions
- Errors in processing

## Best Practices

1. **Secure Secrets** - Keep CRON_SECRET secure
2. **Error Handling** - Implement proper error handling
3. **Idempotency** - Ensure jobs can be safely retried
4. **Monitoring** - Monitor job execution
5. **Testing** - Test thoroughly before production

## Next Steps

- **[Deployment](/developer-guide/deployment/production-setup)** - Production deployment
- **[Architecture](/developer-guide/architecture/project-structure)** - Codebase structure

